# Repository를 리팩터링 하였다

기존의 리파지토리는 단순 JPA를 상속하는 추상체만 존재하였다

이대로 구현하다보니 도메인과 영속성 객체를 분리하지 못하는 단점이 존재하였고, 이는 서비스 코드가 무거워지고 각 클래스간의 역할이 모호해지는 결과를 낳았다

그렇기에 우리는 **Repository를 리팩터링 해야한다**는 결론에 도달한다


리팩터링 과정은 다음과 같다

- 기존의 JPA를 상속받던 repository는 JpaRepository로서 영속성 객체만 받을 수 있도록 한다
- 그리고 이를 구현하는 repositoryImpl을 구현한다: 
  - 해당 클래스에서는 파라미터로 영속성 객체를 받는 것이 아닌, 도메인을 받는다. 그렇기 때문에 영속성 객체안에 toModel 이라는 도메인 -> 영속성 객체로 변환해주는 메서드를 만든다
  - 또한 조회 메서드 사용시 영속성 객체 -> 도메인으로 변환 할 수 있도록 fromModel 메서드를 생성한다
- 그리고 이를 추상화하는 클래스를 repository로 구현함으로써 구현을 마무리한다


# 주의점

이렇게 구현하면 서비스로직이 JPA와 의존성이 매우 낮아진다.

그렇기 때문에 JPA의 주요기능인 **변경감지**가 적용되지 않는다

-> 그렇기 때문에 메서드에 모두 직접 save메서드를 실행해주어야한다는 단점이 존재한다